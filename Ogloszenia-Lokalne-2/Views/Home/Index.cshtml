@model Ogloszenia_Lokalne_2.Models.ViewModels.AdIndexViewModel

@{
    ViewBag.Title = "Home Page";
}

<style type="text/css">


    #blok0 {
        background-color: #dddddd;
        width: 100%;
        padding: 30px;
        padding-bottom: 20px;
    }

    #blok1 {
        padding: 10px;
    }

    #blok2 {
        margin-top: 12px;
    }

    #blok3 {
        background-color: #ffffff;
        padding: 20px;
        text-align: right;
    }

    #blok4 {
        margin-top: 32px;
    }

</style>

@using (Html.BeginForm("Index", "Home", FormMethod.Post))
{
    <div id="blok0" class="col-md-12 form-group form-horizontal">

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.AntiForgeryToken()
        @Html.HiddenFor(model => model.SiteID)
        @Html.HiddenFor(model => model.SiteCount)
        @Html.HiddenFor(model => model.Filtr)
        @Html.HiddenFor(model => model.AdCount)

        <div>
            @if (ViewBag.RoleName == "Admin")
            {
                <br />
                <input type="button" value="Dodaj wiadomość" class="btn btn-success"
                       onclick="location.href='@Url.Action("Create", "Messages")'" />
                <br />
            }
            <br />
            <table class="col-md-12 table-striped table-condensed" style="font-size:24px; padding:20px">
                @foreach (Ogloszenia_Lokalne_2.Models.Message item in Model.Messages)
                {
                    <tr style="background-color:#313131; color:#ff9b20">
                        <td class="col-md-10" style="padding:10px">
                            @Html.DisplayFor(modelItem => item.Content)
                        </td>

                        @if (ViewBag.RoleName == "Admin")
                        {
                            <td>
                                <input type="button" value="Edytuj" class="btn btn-default"
                                       onclick="location.href='@Url.Action("Edit", "Messages", new { id = item.MessageID })'" />
                                <input type="button" value="Usuń" class="btn btn-danger"
                                       onclick="location.href='@Url.Action("Delete", "Messages", new { id = item.MessageID })'" />
                            </td>
                        }
                    </tr>
                }
                @Html.HiddenFor(model => model.Messages)
            </table>
        </div>

        <div class="price_box">

            <div class="col-md-2" id="blok4" style="font-size:22px;">
                Filtruj
                @Html.CheckBoxFor(model => model.Filtr, new { @class = "naCheckbox js-checkbox-disable-toggle",
                @style = "width:1em; height:1em;", data_target = ".disable-toggle-@(i)" })
            </div>

            <div class="col-md-2" id="blok2">
                @Html.DisplayNameFor(model => model.Search)
                @Html.EditorFor(m => m.Search, new { htmlAttributes = new { @class = "price_value disable-toggle-@(i) form-control", data_placeholder = "Wyszukaj..." } })
            </div>

            <div class="col-md-2" id="blok2">
                @Html.DisplayNameFor(model => model.Categories)
                @Html.DropDownListFor(m => m.SelectedCategories, new MultiSelectList(Model.Categories, "CategoryID", "Name"),
                    new { @class = "price_value disable-toggle-@(i) form-control", data_placeholder = "Kategorie..." })
            </div>

            <div class="col-md-2" id="blok2">
                @Html.DisplayNameFor(model => model.FromPrice)
                @Html.EditorFor(m => m.FromPrice, new { htmlAttributes = new { @class = "price_value disable-toggle-@(i) form-control" } })
            </div>

            <div class="col-md-2" id="blok2">
                @Html.DisplayNameFor(model => model.ToPrice)
                @Html.EditorFor(m => m.ToPrice, new { htmlAttributes = new { @class = "price_value disable-toggle-@(i) form-control" } })
            </div>

        </div>

        <div class="col-md-2" id="blok4">
            <input type="submit" value="Odświerz" class="btn btn-warning" style="width:100%; margin-bottom:10px; " />
        </div>

        <table class="table table-hover">

            <tr>
                <th>
                    <h2>Ogloszenia</h2>
                </th>
                <th>
                    <h2>
                        @Html.DisplayNameFor(model => model.ExpampleAd.Title) /
                        @Html.DisplayNameFor(model => model.ExpampleAd.Price)
                    </h2>
                </th>
                <th>
                    <h4>@Html.DisplayNameFor(model => model.ExpampleAd.AddingDate) /</h4>
                    <h4>/ @Html.DisplayNameFor(model => model.ExpampleAd.Views) </h4>
                </th>
            </tr>

            @foreach (Ogloszenia_Lokalne_2.Models.Ad item in ViewBag.Ads)
            {
                <tr onclick="location.href = '@(Url.Action("Details", "Home", new { id = item.AdID }))'">
                    <td style="width:40%; height:200px; padding:15px">
                        <img alt="Image" src="@Url.Content(item.Image)" style="height:100%; width:100%;" />
                    </td>
                    <td style="width:40%; height:200px; padding:15px; font-size:28px;">
                        <div style="background-color:#ffffff; height:100%; padding:20px; ">
                            @Html.ActionLink(item.Title, "Details", new { id = item.AdID })
                            @if (item.IsValuable)
                            {<h3> @Html.DisplayFor(modelItem => item.Price) </h3> }
                        else
                        {<h4><b>BEZCENNE</b></h4>}
                        </div>
                    </td>
                    <td style="width:20%; height:200px; padding:15px; font-size:26px;">
                        <div style="background-color:#eeeeee; height:100%; padding:20px; text-align:right;">
                            @Html.DisplayFor(modelItem => item.AddingDate)
                            <br />
                            @Html.Label("", "Dni: " + DateTime.Now.Subtract(item.AddingDate).Days.ToString())
                            <br />
                            @Html.DisplayFor(modelItem => item.Views)
                        </div>
                    </td>
                </tr>
            }

        </table>

        @if(@Model.SiteCount > 0)
        {
            <div style="color: #313131;" class="label col-md-12">
                <input type="button" value="<" class="btn btn-danger" onclick="location.href='@Url.Action("PreviousSite", @Model)'" />
                <label style="font-size:20px; padding:20px;">@Model.SiteID / @Model.SiteCount</label>
                <input type="button" value=">" class="btn btn-success" onclick="location.href='@Url.Action("Nextsite", @Model)'" />
            </div>
        }

    </div>

}

@section Scripts {

    <script src="~/Scripts/jquery-3.6.0.js"></script>
    <script>

        $('.naCheckbox').before(function () {
            var isChecked = $(this).is(':checked');
            var parent = $(this).closest('.price_box'); // get the enclosing div
            var textbox = parent.find('.price_value'); // get the associated textbox
            textbox.prop('disabled', !isChecked); // use .prop() rather that .attr()
        });

        $('.naCheckbox').click(function () {
            var isChecked = $(this).is(':checked');
            var parent = $(this).closest('.price_box'); // get the enclosing div
            var textbox = parent.find('.price_value'); // get the associated textbox
            textbox.prop('disabled', !isChecked); // use .prop() rather that .attr()
        });

    </script>

    @Scripts.Render("~/bundles/jqueryval")
}
